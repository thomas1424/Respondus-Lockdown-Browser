(()=>{"use strict";var e={2480:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createToolbar=void 0;const n=o(7125);t.createToolbar=()=>{chrome.runtime.onMessage.addListener((e,t,o)=>{"toolbarsignalcheck"==e.action&&o("")}),chrome.storage.local.get("systemState",async e=>{const t=e.systemState;let o=(0,n.geti18nTranslations)(["exit_confirm","yes","no","proctor_password","enter","dismiss","incorrect_password","calculator","exam_link","link_blocked"]);var a;t.overrideLocale&&(o=await(0,n.getTranslations)(o,t.overrideLocale));const r=await chrome.runtime.sendMessage("gettabid"),s=t.examTabTitle,i=t.tabIds,l=t.examTabId,c=t.calculator>0,d=t.monitorTabId,m=t.recordingStarted,g=t.susOpen,y=document.createElement("div"),u="54px",h="6px";y.id="ldbtoolbar",y.style.width="100%",y.style.backgroundColor="#5A5A5A",y.style.height=u,y.style.maxHeight=u,y.style.position="fixed",y.style.left="0px",y.style.top="0px",y.style.zIndex="9999999",y.style.display="flex";const p=document.createElement("ul");p.id="tablist",p.style.listStyleType="none",p.style.overflow="hidden",p.style.margin="0",p.style.padding="0";const b=(e,t,n,r,s)=>{const i=document.createElement("li");i.addEventListener("click",t=>{const o=t.currentTarget;"exit-tab"===t.target.id?chrome.runtime.sendMessage({action:"removetab",tabId:e}):o.id===e.toString()&&chrome.runtime.sendMessage({action:"activatetab",tabId:e})}),e?i.id=e.toString():chrome.runtime.sendMessage({action:"getTabId"},e=>{e.tabId&&(i.id=e.tabId)}),i.style.minWidth="175px",i.style.float="left",i.style.height="51px",i.style.textAlign="left",t===e?(i.style.backgroundColor="white",i.style.color="#4a4a4a"):(i.style.cursor="pointer",i.style.color="white"),t===n&&i.classList.add("exam-tab"),i.style.fontFamily="Arial",i.style.fontSize="medium",i.style.border="solid",i.style.borderColor="gray",i.style.borderWidth="1px",i.style.lineHeight="52px",i.style.userSelect="none";const l=document.createElement("span");t===s&&(a=l),l.id="tab-title",r?l.textContent=r:e===n?l.textContent="Exam":e===t&&location.ancestorOrigins[0]&&location.ancestorOrigins[0].includes("smc-service-cloud.respondus2.com")?l.textContent="Troubleshooter":e===t&&location.ancestorOrigins[0]&&location.ancestorOrigins[0].includes("respondus.knowledgeowl.com")?l.textContent="Knowledge Base":e===t&&window.location.origin.includes("paypal")?l.textContent="PayPal":l.textContent=o.exam_link,l.style.paddingLeft="16px",l.style.paddingRight="16px",i.appendChild(l);const c=document.createElement("button");return c.id="exit-tab",c.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/close-tab.png")}`,c.style.height="15px",c.style.float="right",c.style.marginTop="18px",c.style.marginRight="20px",c.style.marginLeft="10px",c.style.width="20px",c.style.backgroundColor="#5A5A5A",c.style.backgroundSize="cover",c.style.border="none",c.style.borderRadius="3px",c.style.cursor="pointer",n!==e&&i.appendChild(c),i};if((g||t.instructorLiveProctoring)&&d){let e="Pre Exam Checks";t.instructorLiveProctoring&&(e="Live Proctoring"),p.append(b(d,r,d,e,d))}else l&&p.append(b(l,r,l,s));if(i&&l)for(const e of i)p.appendChild(b(e,r,l));const w=document.createElement("div");w.style.position="absolute",w.style.right="0";const x=document.createElement("button");x.addEventListener("click",e=>{chrome.runtime.sendMessage({action:"calculator"})}),x.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/calculator-light.png")}`,x.id="calculator",x.style.float="left",x.style.backgroundSize="cover",x.style.backgroundPosition="center",x.style.width="20px",x.style.height="26px",x.style.border="none",x.style.marginTop="13px",x.style.marginRight="20px",x.style.cursor="pointer",x.style.backgroundColor="#5A5A5A",(!1===c||window.parent.location.href.startsWith("chrome-extension://"))&&(x.style.display="none");let v="URL";const f=document.createElement("span");f.addEventListener("click",()=>{f.textContent===o.link_blocked?f.textContent=v:w.removeChild(f)}),f.id="blocked-url",f.style.position="absolute",f.style.zIndex="10",f.style.top="0",f.style.right="100px",f.style.border="solid",f.style.borderRadius=h,f.style.backgroundColor="#ebd2d5",f.textContent=o.link_blocked,f.style.color="#ae0015",f.style.marginLeft="15px",f.style.padding="3px 5px 3px 5px",f.style.lineHeight="40px",f.style.fontFamily="Arial",f.style.fontSize="medium";const L=document.createElement("span");L.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/recording-icon.png")}`,L.id="recording-icon",L.style.float="left",L.style.backgroundSize="cover",L.style.backgroundPosition="center",L.style.width="60px",L.style.height="20px",L.style.border="none",L.style.borderRadius=h,L.style.marginTop="15px",L.style.marginRight="20px",!1===m&&(L.style.display="none");const k=async e=>{const t=(await chrome.storage.local.get("systemState")).systemState,o=t.earlyExit,n=t.earlyExitReason,a=!(!t.proctorExitPassword&&!t.hasTestPassword),s=t.monitorTabId,i=t.susOpen,l=t.instructorLiveProctoring,c=t.lmsType;(o||n||a||c||s===r&&i||s===r&&l)&&chrome.runtime.sendMessage({action:"showearlyexit"})},T=document.createElement("button");T.addEventListener("click",k),T.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/x-square.png")}`,T.id="exit-button",T.style.backgroundSize="cover",T.style.backgroundPosition="center",T.style.width="30px",T.style.height="30px",T.style.borderRadius=h,T.style.border="none",T.style.marginTop="10px",T.style.marginRight="10px",T.style.cursor="pointer",y.appendChild(p),y.appendChild(w),w.appendChild(L),w.appendChild(x),w.appendChild(T);const C=document.createElement("div");C.id="ldbtoolbar-shadow",document.body.appendChild(C);const R=C.attachShadow({mode:"open"});R.appendChild(y),chrome.runtime.onMessage.addListener((e,t,n)=>{if("newtab"===e.action&&l&&p.appendChild(b(e.newTabId,r,l,e.newTabTitle)),"removetab"===e.action&&document){const t=R.getElementById(e.tabId);t&&p.removeChild(t)}"blockedurlerror"===e.action&&(v=e.url,f.textContent=o.link_blocked,y.appendChild(f)),"recordingstarted"===e.action&&(L.style.display="block"),"recordingended"===e.action&&(L.style.display="none",r===d&&a&&(a.textContent="Post Exam")),"allowearlyexit"===e.action&&T.addEventListener("click",k),"allowcalculator"!==e.action||window.parent.location.href.startsWith("chrome-extension://")||(x.style.display="block"),"disableearlyexit"===e.action&&(T.removeEventListener("click",k),e.allowPassword&&T.addEventListener("click",k))})})}},7125:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createBlankImage=t.getTabTitle=t.getUrlObj=t.SHA256=t.extractPathId=t.isInjected=t.isIllegalTab=t.isValidUrl=t.getChromeVersion=t.extractSearchParams=t.notifyAllTabs=t.getAllTabs=t.getActiveTab=t.parseParentheticalList=t.setOverrideLocale=t.getTranslation=t.getTranslations=t.geti18nTranslations=t.getGLobalServer=t.resetLaunchTab=t.combineTabsToWindow=t.containsDomainPattern=t.containsAllowedDomains=t.containsUrlPattern=t.getArrayFromUrlParam=t.getDomainUrlFromURL=t.extractXML=t.cleanHistory=t.cleanLDBHistory=t.removeLDBCookies=t.removeLMSCookies=t.setCookie=void 0;t.setCookie=async(e,t,o,n)=>{try{const a=new URL(t);["http:","https:"].includes(a.protocol)&&await chrome.cookies.set({name:e,url:a.origin,value:encodeURIComponent(o),domain:n})}catch(e){}};t.removeLMSCookies=async e=>{const t=new URL(e),o=await chrome.cookies.getAll({url:t.origin});for(const e of o)await chrome.cookies.remove({name:e.name,url:t.origin})};t.removeLDBCookies=async()=>{const e=["rldbcv","rldbacv","rldbrv","rldbarv","rldbswipe","rldbsc","rldbsi","rldbci","_MS","LDB"];for(const t of e){const e=await chrome.cookies.getAll({name:t});for(const t of e)await chrome.cookies.remove({name:t.name,url:`https://${t.domain}`})}};t.cleanLDBHistory=async(e,t)=>{(e.includes(t)||e.includes(chrome.runtime.id))&&chrome.history.deleteUrl({url:e})};t.cleanHistory=async e=>{await chrome.history.deleteRange({startTime:e,endTime:Date.now()})};t.extractXML=(e,t)=>{const o=new RegExp(`<${e}>(.*?)</${e}>`),n=t.match(o);return n?n[1]:null};t.getDomainUrlFromURL=e=>{try{return new URL(e).origin}catch(e){}return null};t.getArrayFromUrlParam=(e,t)=>{const o=new URL(e);var n=o.searchParams,a=o.hash.indexOf("?");0===n.size&&-1!==a&&(n=new URLSearchParams(o.hash.slice(a)));const r=n.get(t);return r&&r.startsWith("(")&&r.endsWith(")")?r.slice(1,-1).split(",").map(e=>e.trim()):[]};t.containsUrlPattern=(e,t)=>{for(const o of t){const t=o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*");if(new RegExp(t).test(e))return!0}return!1};t.containsAllowedDomains=(e,t)=>{var o=!1;try{var n=new URL(e).host;let t=n.split(".");t.length>1&&(n=t.slice(-2).join("."))}catch(e){return!1}return t.forEach(e=>{e.split(".").length>1&&(e=e.split(".").splice(-2).join(".")),n==e&&(o=!0)}),o};t.containsDomainPattern=(e,t)=>{try{const o=new URL(e).hostname;for(const e of t){const t=e.replace(/\./g,"\\.").replace(/\*/g,".*");if(new RegExp(`^${t}$`).test(o))return!0}return!1}catch(e){return!1}};t.combineTabsToWindow=async e=>{const t=await chrome.windows.getLastFocused();for(const o of e)await chrome.tabs.move(o,{windowId:t.id,index:-1})};t.resetLaunchTab=async(e,t,o,n,a)=>{n&&t.includes(o)&&(n=a),n&&await chrome.tabs.update(e,{url:n,active:!1})};t.getGLobalServer=async()=>{const e=await chrome.runtime.sendMessage({action:"getGlobalServer"});try{return new URL(e.globalServer),e.globalServer}catch(e){return null}};t.geti18nTranslations=e=>{let t={};for(const o of e)t[o]=chrome.i18n.getMessage(o);return t};t.getTranslations=async(e,t)=>{const o="_locales/"+t+"/messages.json";try{const t=await(await fetch(chrome.runtime.getURL(o))).json();for(const o of Object.keys(e))e[o]=t[o].message}catch(e){}return e};t.getTranslation=async(e,t)=>{if(t){const o="_locales/"+t+"/messages.json";return(await(await fetch(chrome.runtime.getURL(o))).json())[e].message}return chrome.i18n.getMessage(e)};t.setOverrideLocale=async(e,t,o)=>{if(!1===t.includes(e))try{const t=new Intl.Locale(e.replace("_","-")).language;await o.set("overrideLocale",t)}catch(e){}else await o.set("overrideLocale",e)};t.parseParentheticalList=e=>(e&&(e=(e=e.replace(/[()]| /g,"")).toLowerCase()),e?e.split(","):[]);t.getActiveTab=async e=>(await chrome.tabs.query({active:!0,windowId:e}))[0];t.getAllTabs=async()=>await chrome.tabs.query({});t.notifyAllTabs=async e=>{const o=await(0,t.getAllTabs)();for(const t of o)t.id&&chrome.tabs.sendMessage(t.id,e)};t.extractSearchParams=e=>{const t=new URL(e);var o=t.searchParams,n=t.hash.indexOf("?");return 0===o.size&&-1!==n&&(o=new URLSearchParams(t.hash.slice(n))),o};t.getChromeVersion=()=>{try{const e=navigator.userAgent.match(/Chrome\/([\d.]+)/)?.[1];if(e)return parseFloat(e)}catch(e){}return null};t.isValidUrl=e=>{try{const t=new URL(e);if(!0===["http:","https:"].includes(t.protocol))return!0}catch(e){}return!1};t.isIllegalTab=(e,t,o)=>!(!e.id||!e.url||e.url.includes(chrome.runtime.id)||e.openerTabId&&o.includes(e.openerTabId)||!t||e.id===t||o.includes(e.id)&&!e.url.includes("ws.readspeaker.com"));t.isInjected=async(e,t,o)=>await new Promise(n=>{void 0!==o?chrome.tabs.sendMessage(e,{action:t},{frameId:o},e=>{chrome.runtime.lastError?n(!1):n(!0)}):chrome.tabs.sendMessage(e,{action:t},e=>{chrome.runtime.lastError?n(!1):n(!0)})});t.extractPathId=(e,t)=>{const o=new RegExp(`/${t}/(\\d+)(?=/|\\?|$)`),n=e.match(o);if(n)return n[1]};t.SHA256=async e=>{const t=(new TextEncoder).encode(e),o=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(o)).map(e=>e.toString(16).padStart(2,"0")).join("")};t.getUrlObj=e=>{try{return new URL(e)}catch(e){}};t.getTabTitle=e=>"canvasclassic"===e||"canvasnew"===e?"Canvas":"moodle"===e?"Moodle":"blackboardog"===e||"blackboardultra"===e?"Blackboard":"d2l"===e?"Brightspace":"infinitecampus"===e?"Infinite":"schoology"===e?"Schoology":void 0;t.createBlankImage=async(e=1920,t=1080)=>{try{const o=new OffscreenCanvas(e,t),n=o.getContext("2d");n&&(n.fillStyle="#000000",n.fillRect(0,0,e,t));const a=await o.convertToBlob({type:"image/png"});return await a.arrayBuffer()}catch(e){return null}}}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}(0,o(2480).createToolbar)()})();