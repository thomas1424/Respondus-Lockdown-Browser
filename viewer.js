(()=>{"use strict";var e={2480:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createToolbar=void 0;const n=a(7125);t.createToolbar=()=>{chrome.runtime.onMessage.addListener((e,t,a)=>{"toolbarsignalcheck"==e.action&&a("")}),chrome.storage.local.get("systemState",async e=>{const t=e.systemState;let a=(0,n.geti18nTranslations)(["exit_confirm","yes","no","proctor_password","enter","dismiss","incorrect_password","calculator","exam_link","link_blocked"]);var r;t.overrideLocale&&(a=await(0,n.getTranslations)(a,t.overrideLocale));const o=await chrome.runtime.sendMessage("gettabid"),s=t.examTabTitle,i=t.tabIds,l=t.examTabId,c=t.calculator>0,d=t.monitorTabId,y=t.recordingStarted,m=t.susOpen,p=document.createElement("div"),g="54px",u="6px";p.id="ldbtoolbar",p.style.width="100%",p.style.backgroundColor="#5A5A5A",p.style.height=g,p.style.maxHeight=g,p.style.position="fixed",p.style.left="0px",p.style.top="0px",p.style.zIndex="9999999",p.style.display="flex";const h=document.createElement("ul");h.id="tablist",h.style.listStyleType="none",h.style.overflow="hidden",h.style.margin="0",h.style.padding="0";const b=(e,t,n,o,s)=>{const i=document.createElement("li");i.addEventListener("click",t=>{const a=t.currentTarget;"exit-tab"===t.target.id?chrome.runtime.sendMessage({action:"removetab",tabId:e}):a.id===e.toString()&&chrome.runtime.sendMessage({action:"activatetab",tabId:e})}),e?i.id=e.toString():chrome.runtime.sendMessage({action:"getTabId"},e=>{e.tabId&&(i.id=e.tabId)}),i.style.minWidth="175px",i.style.float="left",i.style.height="51px",i.style.textAlign="left",t===e?(i.style.backgroundColor="white",i.style.color="#4a4a4a"):(i.style.cursor="pointer",i.style.color="white"),t===n&&i.classList.add("exam-tab"),i.style.fontFamily="Arial",i.style.fontSize="medium",i.style.border="solid",i.style.borderColor="gray",i.style.borderWidth="1px",i.style.lineHeight="52px",i.style.userSelect="none";const l=document.createElement("span");t===s&&(r=l),l.id="tab-title",o?l.textContent=o:e===n?l.textContent="Exam":e===t&&location.ancestorOrigins[0]&&location.ancestorOrigins[0].includes("smc-service-cloud.respondus2.com")?l.textContent="Troubleshooter":e===t&&location.ancestorOrigins[0]&&location.ancestorOrigins[0].includes("respondus.knowledgeowl.com")?l.textContent="Knowledge Base":e===t&&window.location.origin.includes("paypal")?l.textContent="PayPal":l.textContent=a.exam_link,l.style.paddingLeft="16px",l.style.paddingRight="16px",i.appendChild(l);const c=document.createElement("button");return c.id="exit-tab",c.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/close-tab.png")}`,c.style.height="15px",c.style.float="right",c.style.marginTop="18px",c.style.marginRight="20px",c.style.marginLeft="10px",c.style.width="20px",c.style.backgroundColor="#5A5A5A",c.style.backgroundSize="cover",c.style.border="none",c.style.borderRadius="3px",c.style.cursor="pointer",n!==e&&i.appendChild(c),i};if((m||t.instructorLiveProctoring)&&d){let e="Pre Exam Checks";t.instructorLiveProctoring&&(e="Live Proctoring"),h.append(b(d,o,d,e,d))}else l&&h.append(b(l,o,l,s));if(i&&l)for(const e of i)h.appendChild(b(e,o,l));const w=document.createElement("div");w.style.position="absolute",w.style.right="0";const v=document.createElement("button");v.addEventListener("click",e=>{chrome.runtime.sendMessage({action:"calculator"})}),v.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/calculator-light.png")}`,v.id="calculator",v.style.float="left",v.style.backgroundSize="cover",v.style.backgroundPosition="center",v.style.width="20px",v.style.height="26px",v.style.border="none",v.style.marginTop="13px",v.style.marginRight="20px",v.style.cursor="pointer",v.style.backgroundColor="#5A5A5A",(!1===c||window.parent.location.href.startsWith("chrome-extension://"))&&(v.style.display="none");let f="URL";const x=document.createElement("span");x.addEventListener("click",()=>{x.textContent===a.link_blocked?x.textContent=f:w.removeChild(x)}),x.id="blocked-url",x.style.position="absolute",x.style.zIndex="10",x.style.top="0",x.style.right="100px",x.style.border="solid",x.style.borderRadius=u,x.style.backgroundColor="#ebd2d5",x.textContent=a.link_blocked,x.style.color="#ae0015",x.style.marginLeft="15px",x.style.padding="3px 5px 3px 5px",x.style.lineHeight="40px",x.style.fontFamily="Arial",x.style.fontSize="medium";const k=document.createElement("span");k.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/recording-icon.png")}`,k.id="recording-icon",k.style.float="left",k.style.backgroundSize="cover",k.style.backgroundPosition="center",k.style.width="60px",k.style.height="20px",k.style.border="none",k.style.borderRadius=u,k.style.marginTop="15px",k.style.marginRight="20px",!1===y&&(k.style.display="none");const L=async e=>{const t=(await chrome.storage.local.get("systemState")).systemState,a=t.earlyExit,n=t.earlyExitReason,r=!(!t.proctorExitPassword&&!t.hasTestPassword),s=t.monitorTabId,i=t.susOpen,l=t.instructorLiveProctoring,c=t.lmsType;(a||n||r||c||s===o&&i||s===o&&l)&&chrome.runtime.sendMessage({action:"showearlyexit"})},T=document.createElement("button");T.addEventListener("click",L),T.style.backgroundImage=`url(${chrome.runtime.getURL("/assets/images/x-square.png")}`,T.id="exit-button",T.style.backgroundSize="cover",T.style.backgroundPosition="center",T.style.width="30px",T.style.height="30px",T.style.borderRadius=u,T.style.border="none",T.style.marginTop="10px",T.style.marginRight="10px",T.style.cursor="pointer",p.appendChild(h),p.appendChild(w),w.appendChild(k),w.appendChild(v),w.appendChild(T);const _=document.createElement("div");_.id="ldbtoolbar-shadow",document.body.appendChild(_);const C=_.attachShadow({mode:"open"});C.appendChild(p),chrome.runtime.onMessage.addListener((e,t,n)=>{if("newtab"===e.action&&l&&h.appendChild(b(e.newTabId,o,l,e.newTabTitle)),"removetab"===e.action&&document){const t=C.getElementById(e.tabId);t&&h.removeChild(t)}"blockedurlerror"===e.action&&(f=e.url,x.textContent=a.link_blocked,p.appendChild(x)),"recordingstarted"===e.action&&(k.style.display="block"),"recordingended"===e.action&&(k.style.display="none",o===d&&r&&(r.textContent="Post Exam")),"allowearlyexit"===e.action&&T.addEventListener("click",L),"allowcalculator"!==e.action||window.parent.location.href.startsWith("chrome-extension://")||(v.style.display="block"),"disableearlyexit"===e.action&&(T.removeEventListener("click",L),e.allowPassword&&T.addEventListener("click",L))})})}},2904:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEarlyExit=void 0;t.createEarlyExit=()=>{const e=document.createElement("iframe");e.src=chrome.runtime.getURL("early_exit.html"),e.style.position="fixed",e.style.zIndex="9999999999",e.style.left="50%",e.style.top="50%",e.style.transform="translate(-50%, -50%)",e.style.border="none",e.style.width="602px",e.style.height="302px",e.id="earlyexitframe",document.body.appendChild(e);const t=(e,t,a)=>{"earlyexitsignalcheck"===e.action&&a({action:!0})},a=n=>{"removeldbearlyexit"===n.data&&(document.body.removeChild(e),window.removeEventListener("message",a),chrome.runtime.onMessage.removeListener(t))};chrome.runtime.onMessage.addListener(t),window.addEventListener("message",a)}},4391:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.protectPage=void 0;t.protectPage=async(e,t,a,n,r,o=!0)=>{const s=(n=n||window)?n.document.body:document.body,i=o?"":"_standard";s.addEventListener("contextmenu",e=>{e.preventDefault()});const l=n===window.parent;var c=null,d=!1,y=!1;const m=()=>{p(),s.innerHTML="",h("The extension has been uninstalled which is not permitted."),setTimeout(()=>{n.location.href=n.origin},4e3)},p=()=>{const e=document.cookie.split(";");for(let t=0;t<e.length;t++){const a=e[t],n=a.indexOf("=");let r=n>-1?a.substr(0,n):a;document.cookie=r+="=;expires=Thu, 01 Jan  1970 00:00:00 GMT;path=/"}},g=async()=>{try{const t=await navigator.clipboard.read();t[0]&&t[0].types.includes("image/png")&&(await navigator.clipboard.writeText(" "),d=!0,e&&h(e.screenshot_warning),chrome.runtime.sendMessage("screenshotdetected",t=>{t.screenshotCount>1&&(y=!0,e&&h(e.screenshot_exit))}))}catch(e){}},u=async(e,t)=>{if(t&&n.location.href.includes(t)){if("granted"===(await navigator.permissions.query({name:"clipboard-write"})).state&&(await(async()=>{try{for(let e=1;e<11;e++)await navigator.clipboard.writeText(" ".repeat(e))}catch(e){}})(),e)){await navigator.permissions.query({name:"clipboard-read"})&&setInterval(g,3e3)}}},h=e=>{c&&c.remove(),(c=document.createElement("div")).style.backgroundColor="rgb(239, 239, 239)",c.style.position="fixed",c.style.width="100%",c.style.top="0",c.style.left="0",c.style.zIndex="3000",c.style.height="100%";const t=document.createElement("p");t.style.textAlign="left",t.style.position="absolute",t.style.top="200px",t.style.left="40px",t.style.fontFamily="verdana",t.style.fontSize="24px",t.style.wordWrap="break-word",t.style.whiteSpace="normal",t.style.color="black",t.style.lineHeight="1",e&&(t.innerHTML=e),c.appendChild(t),s.appendChild(c)},b=()=>{c&&!y&&(c.remove(),c=null)},w=(t,a,n)=>{"focuslost"===t.action&&e&&h(e[`focus_lost_warning${i}`]),"focuslostlimit"===t.action&&e&&(h(e[`focus_lost_exit${i}`]),y=!0),"displaychange"===t.action&&e&&(h(e.secondary_display_exit),y=!0),"protectpagesignalcheck"===t.action&&n("response")},v=t=>{"showoverlay"===t.data&&h(),"hideoverlay"===t.data&&b(),"showoverlay-ctrlalt"===t.data&&e&&h(e.ctrl_alt_shift_warning)};s.addEventListener("keydown",t=>{!t.ctrlKey||t.shiftKey||t.altKey||(l?h():window.parent.postMessage("showoverlay","*")),t.ctrlKey&&t.shiftKey&&(t.preventDefault(),d=!0,l&&e?h(e.ctrl_alt_shift_warning):window.parent.postMessage("showoverlay-ctrlalt","*")),t.ctrlKey&&t.altKey&&(t.preventDefault(),d=!0,l&&e?h(e.ctrl_alt_shift_warning):window.parent.postMessage("showoverlay-ctrlalt","*")),(t.ctrlKey||t.metaKey)&&"p"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"s"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"w"===t.key&&t.preventDefault(),!t.ctrlKey&&!t.metaKey||"h"!==t.key&&"j"!==t.key||t.preventDefault(),!t.ctrlKey&&!t.metaKey||"k"!==t.key&&"l"!==t.key||t.preventDefault(),!t.ctrlKey&&!t.metaKey||"t"!==t.key&&"n"!==t.key||t.preventDefault(),(t.ctrlKey||t.metaKey)&&"d"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"u"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"o"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"f"===t.key&&"gp"===r&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"r"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&"Tab"===t.key&&t.preventDefault(),(t.ctrlKey||t.metaKey)&&/^[1-9]$/.test(t.key)&&t.preventDefault(),"F12"===t.key&&t.preventDefault(),"Escape"===t.key&&(d=!1,l?b():window.parent.postMessage("hideoverlay","*"))}),s.addEventListener("keyup",e=>{"Control"!==e.key||d||(l?b():window.parent.postMessage("hideoverlay","*"))}),l&&(n.addEventListener("message",v),chrome.runtime.onMessage.addListener(w)),s.addEventListener("contextmenu",e=>{e.preventDefault()}),t&&u(l,a),setInterval(()=>{chrome.runtime.id||m()},5e3),history.pushState(null,"",location.href),n.onpopstate=()=>{history.go(1)}}},7125:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createBlankImage=t.getTabTitle=t.getUrlObj=t.SHA256=t.extractPathId=t.isInjected=t.isIllegalTab=t.isValidUrl=t.getChromeVersion=t.extractSearchParams=t.notifyAllTabs=t.getAllTabs=t.getActiveTab=t.parseParentheticalList=t.setOverrideLocale=t.getTranslation=t.getTranslations=t.geti18nTranslations=t.getGLobalServer=t.resetLaunchTab=t.combineTabsToWindow=t.containsDomainPattern=t.containsAllowedDomains=t.containsUrlPattern=t.getArrayFromUrlParam=t.getDomainUrlFromURL=t.extractXML=t.cleanHistory=t.cleanLDBHistory=t.removeLDBCookies=t.removeLMSCookies=t.setCookie=void 0;t.setCookie=async(e,t,a,n)=>{try{const r=new URL(t);["http:","https:"].includes(r.protocol)&&await chrome.cookies.set({name:e,url:r.origin,value:encodeURIComponent(a),domain:n})}catch(e){}};t.removeLMSCookies=async e=>{const t=new URL(e),a=await chrome.cookies.getAll({url:t.origin});for(const e of a)await chrome.cookies.remove({name:e.name,url:t.origin})};t.removeLDBCookies=async()=>{const e=["rldbcv","rldbacv","rldbrv","rldbarv","rldbswipe","rldbsc","rldbsi","rldbci","_MS","LDB"];for(const t of e){const e=await chrome.cookies.getAll({name:t});for(const t of e)await chrome.cookies.remove({name:t.name,url:`https://${t.domain}`})}};t.cleanLDBHistory=async(e,t)=>{(e.includes(t)||e.includes(chrome.runtime.id))&&chrome.history.deleteUrl({url:e})};t.cleanHistory=async e=>{await chrome.history.deleteRange({startTime:e,endTime:Date.now()})};t.extractXML=(e,t)=>{const a=new RegExp(`<${e}>(.*?)</${e}>`),n=t.match(a);return n?n[1]:null};t.getDomainUrlFromURL=e=>{try{return new URL(e).origin}catch(e){}return null};t.getArrayFromUrlParam=(e,t)=>{const a=new URL(e);var n=a.searchParams,r=a.hash.indexOf("?");0===n.size&&-1!==r&&(n=new URLSearchParams(a.hash.slice(r)));const o=n.get(t);return o&&o.startsWith("(")&&o.endsWith(")")?o.slice(1,-1).split(",").map(e=>e.trim()):[]};t.containsUrlPattern=(e,t)=>{for(const a of t){const t=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*");if(new RegExp(t).test(e))return!0}return!1};t.containsAllowedDomains=(e,t)=>{var a=!1;try{var n=new URL(e).host;let t=n.split(".");t.length>1&&(n=t.slice(-2).join("."))}catch(e){return!1}return t.forEach(e=>{e.split(".").length>1&&(e=e.split(".").splice(-2).join(".")),n==e&&(a=!0)}),a};t.containsDomainPattern=(e,t)=>{try{const a=new URL(e).hostname;for(const e of t){const t=e.replace(/\./g,"\\.").replace(/\*/g,".*");if(new RegExp(`^${t}$`).test(a))return!0}return!1}catch(e){return!1}};t.combineTabsToWindow=async e=>{const t=await chrome.windows.getLastFocused();for(const a of e)await chrome.tabs.move(a,{windowId:t.id,index:-1})};t.resetLaunchTab=async(e,t,a,n,r)=>{n&&t.includes(a)&&(n=r),n&&await chrome.tabs.update(e,{url:n,active:!1})};t.getGLobalServer=async()=>{const e=await chrome.runtime.sendMessage({action:"getGlobalServer"});try{return new URL(e.globalServer),e.globalServer}catch(e){return null}};t.geti18nTranslations=e=>{let t={};for(const a of e)t[a]=chrome.i18n.getMessage(a);return t};t.getTranslations=async(e,t)=>{const a="_locales/"+t+"/messages.json";try{const t=await(await fetch(chrome.runtime.getURL(a))).json();for(const a of Object.keys(e))e[a]=t[a].message}catch(e){}return e};t.getTranslation=async(e,t)=>{if(t){const a="_locales/"+t+"/messages.json";return(await(await fetch(chrome.runtime.getURL(a))).json())[e].message}return chrome.i18n.getMessage(e)};t.setOverrideLocale=async(e,t,a)=>{if(!1===t.includes(e))try{const t=new Intl.Locale(e.replace("_","-")).language;await a.set("overrideLocale",t)}catch(e){}else await a.set("overrideLocale",e)};t.parseParentheticalList=e=>(e&&(e=(e=e.replace(/[()]| /g,"")).toLowerCase()),e?e.split(","):[]);t.getActiveTab=async e=>(await chrome.tabs.query({active:!0,windowId:e}))[0];t.getAllTabs=async()=>await chrome.tabs.query({});t.notifyAllTabs=async e=>{const a=await(0,t.getAllTabs)();for(const t of a)t.id&&chrome.tabs.sendMessage(t.id,e)};t.extractSearchParams=e=>{const t=new URL(e);var a=t.searchParams,n=t.hash.indexOf("?");return 0===a.size&&-1!==n&&(a=new URLSearchParams(t.hash.slice(n))),a};t.getChromeVersion=()=>{try{const e=navigator.userAgent.match(/Chrome\/([\d.]+)/)?.[1];if(e)return parseFloat(e)}catch(e){}return null};t.isValidUrl=e=>{try{const t=new URL(e);if(!0===["http:","https:"].includes(t.protocol))return!0}catch(e){}return!1};t.isIllegalTab=(e,t,a)=>!(!e.id||!e.url||e.url.includes(chrome.runtime.id)||e.openerTabId&&a.includes(e.openerTabId)||!t||e.id===t||a.includes(e.id)&&!e.url.includes("ws.readspeaker.com"));t.isInjected=async(e,t,a)=>await new Promise(n=>{void 0!==a?chrome.tabs.sendMessage(e,{action:t},{frameId:a},e=>{chrome.runtime.lastError?n(!1):n(!0)}):chrome.tabs.sendMessage(e,{action:t},e=>{chrome.runtime.lastError?n(!1):n(!0)})});t.extractPathId=(e,t)=>{const a=new RegExp(`/${t}/(\\d+)(?=/|\\?|$)`),n=e.match(a);if(n)return n[1]};t.SHA256=async e=>{const t=(new TextEncoder).encode(e),a=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(a)).map(e=>e.toString(16).padStart(2,"0")).join("")};t.getUrlObj=e=>{try{return new URL(e)}catch(e){}};t.getTabTitle=e=>"canvasclassic"===e||"canvasnew"===e?"Canvas":"moodle"===e?"Moodle":"blackboardog"===e||"blackboardultra"===e?"Blackboard":"d2l"===e?"Brightspace":"infinitecampus"===e?"Infinite":"schoology"===e?"Schoology":void 0;t.createBlankImage=async(e=1920,t=1080)=>{try{const a=new OffscreenCanvas(e,t),n=a.getContext("2d");n&&(n.fillStyle="#000000",n.fillRect(0,0,e,t));const r=await a.convertToBlob({type:"image/png"});return await r.arrayBuffer()}catch(e){return null}}}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,a),o.exports}(()=>{const e=a(7125),t=a(4391),n=a(2480),r=a(2904);chrome.storage.local.get("systemState",async a=>{let r=(0,e.geti18nTranslations)(["screenshot_warning","screenshot_exit","focus_lost_warning"+(a.systemState.lmsType?"":"_standard"),"focus_lost_exit"+(a.systemState.lmsType?"":"_standard"),"ctrl_alt_shift_warning","secondary_display_exit","dev_tool_exit","continue_to_exit","continue"]);a.systemState.overrideLocale&&(r=await(0,e.getTranslations)(r,a.systemState.overrideLocale)),(0,t.protectPage)(r,!1,a.systemState.lmsUrl,null,null,!!a.systemState.lmsType),(0,n.createToolbar)()}),chrome.runtime.onMessage.addListener((e,t,a)=>{"createearlyexit"===e.action&&(0,r.createEarlyExit)()})})()})();